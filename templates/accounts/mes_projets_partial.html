<div class="flex justify-between items-center mb-6">
  <h3 class="text-lg font-medium text-gray-900">Tous mes projets</h3>
  <div class="flex space-x-3">
    <select
      class="border border-gray-300 rounded-md px-3 py-2 text-sm"
      onchange="filterProjects(this.value)"
    >
      <option value="">Tous les statuts</option>
      <option value="en_cours">En cours</option>
      <option value="termine">Terminé</option>
      <option value="annule">Annulé</option>
    </select>
    <a
      href="{% url 'accounts:nouveau_projet' %}"
      class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"
    >
      <i class="fas fa-plus mr-2"></i>
      Nouveau projet
    </a>
  </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="projects-grid">
  {% for project in projets %}
  <div
    class="project-card border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow"
    data-status="{{ project.statut }}"
  >
    <div class="p-4">
      <div class="flex items-center justify-between mb-2">
        <h4 class="font-medium text-gray-900 truncate">{{ project.titre }}</h4>
        <span
          class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium {% if project.statut == 'termine' %}bg-green-100 text-green-800 {% elif project.statut == 'en_cours' %}bg-yellow-100 text-yellow-800 {% elif project.statut == 'annule' %}bg-red-100 text-red-800 {% else %}bg-gray-100 text-gray-800{% endif %}"
        >
          {{ project.get_statut_display }}
        </span>
      </div>

      <p class="text-sm text-gray-600 mb-3">{{ project.description|truncatewords:10 }}</p>

      <div class="flex justify-between items-center text-sm text-gray-500 mb-3">
        <span>{{ project.date_creation|date:"d/m/Y" }}</span>
      </div>

      {% if project.statut == 'en_cours' %}
      <div class="mb-3">
        <div class="flex justify-between text-xs text-gray-600 mb-1">
          <span>Progression</span>
          <span>50%</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-1.5">
          <div class="bg-blue-600 h-1.5 rounded-full" style="width: 50%"></div>
        </div>
      </div>
      {% endif %}

      <div class="flex space-x-2">
        <a
          href="{% url 'accounts:editer_projet' project.id %}"
          class="flex-1 text-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"
        >
          Voir détails
        </a>
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col-span-full text-center py-12">
    <i class="fas fa-project-diagram text-gray-300 text-6xl mb-4"></i>
    <h3 class="text-lg font-medium text-gray-900 mb-2">Aucun projet trouvé</h3>
    <p class="text-gray-500 mb-6">
      Commencez votre premier projet en demandant un devis gratuit.
    </p>
    <a
      href="{% url 'accounts:nouveau_projet' %}"
      class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"
    >
      <i class="fas fa-plus mr-2"></i>
      Demander un devis
    </a>
  </div>
  {% endfor %}
</div>

<script>
  function filterProjects(status) {
    const projects = document.querySelectorAll('.project-card');
    projects.forEach((project) => {
      if (status === '' || project.dataset.status === status) {
        project.style.display = 'block';
      } else {
        project.style.display = 'none';
      }
    });
  }
</script>