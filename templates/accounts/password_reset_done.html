{% extends 'accounts/base_auth.html' %}
{% load static %}

{% block title %}Email envoyé - Lopes Peinture{% endblock %}

{% block content %}
<div class="w-full max-w-md space-y-8">
  <!-- Header -->
  <div class="text-center">
    <div class="mx-auto h-20 w-20 bg-gradient-to-r from-green-600 to-emerald-600 rounded-full flex items-center justify-center mb-6 shadow-lg animate-pulse-slow">
      <i class="fas fa-paper-plane text-white text-2xl"></i>
    </div>
    <h2 class="text-3xl font-bold text-gray-900 mb-2 animate-slide-up">Email envoyé !</h2>
    <p class="text-gray-600 text-lg max-w-md mx-auto animate-fade-in leading-relaxed">
      Nous avons envoyé les instructions de réinitialisation de mot de passe à votre adresse email.
    </p>
  </div>

  <!-- Success Message -->
  <div class="bg-green-50 border border-green-200 rounded-xl p-6 animate-slide-up">
    <div class="flex items-start">
      <div class="flex-shrink-0">
        <i class="fas fa-check-circle text-green-500 text-2xl"></i>
      </div>
      <div class="ml-4 flex-1">
        <h3 class="text-lg font-semibold text-green-800 mb-3">Vérifiez votre boîte email</h3>
        <div class="text-sm text-green-700 space-y-2">
          <p>Un email contenant un lien de réinitialisation a été envoyé à votre adresse.</p>
          <p><strong>Important :</strong> Vérifiez également votre dossier spam/courrier indésirable.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Instructions Card -->
  <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100 animate-slide-up">
    <h3 class="text-xl font-bold text-gray-900 mb-6 text-center">
      <i class="fas fa-list-ul mr-2 text-brand-primary"></i>
      Étapes suivantes
    </h3>

    <div class="space-y-4">
      <div class="flex items-start space-x-4 p-4 bg-blue-50 rounded-xl">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-brand-primary rounded-full flex items-center justify-center">
            <span class="text-white font-bold text-sm">1</span>
          </div>
        </div>
        <div class="flex-1">
          <h4 class="font-semibold text-gray-900 mb-1">Ouvrez votre email</h4>
          <p class="text-sm text-gray-600">Recherchez un email de Lopes Peinture dans votre boîte de réception.</p>
        </div>
      </div>

      <div class="flex items-start space-x-4 p-4 bg-blue-50 rounded-xl">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-brand-primary rounded-full flex items-center justify-center">
            <span class="text-white font-bold text-sm">2</span>
          </div>
        </div>
        <div class="flex-1">
          <h4 class="font-semibold text-gray-900 mb-1">Cliquez sur le lien</h4>
          <p class="text-sm text-gray-600">Suivez le lien sécurisé pour accéder à la page de réinitialisation.</p>
        </div>
      </div>

      <div class="flex items-start space-x-4 p-4 bg-blue-50 rounded-xl">
        <div class="flex-shrink-0">
          <div class="w-8 h-8 bg-brand-primary rounded-full flex items-center justify-center">
            <span class="text-white font-bold text-sm">3</span>
          </div>
        </div>
        <div class="flex-1">
          <h4 class="font-semibold text-gray-900 mb-1">Créez votre nouveau mot de passe</h4>
          <p class="text-sm text-gray-600">Choisissez un mot de passe fort et sécurisé pour votre compte.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Info Box -->
  <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 animate-slide-up">
    <div class="flex items-start">
      <div class="flex-shrink-0">
        <i class="fas fa-clock text-yellow-600 text-lg"></i>
      </div>
      <div class="ml-3">
        <h4 class="text-sm font-semibold text-yellow-800 mb-2">Validité du lien</h4>
        <p class="text-sm text-yellow-700">
          Le lien de réinitialisation est valable pendant <strong>24 heures</strong>.
          Passé ce délai, vous devrez refaire une demande.
        </p>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="space-y-4">
    <a
      href="{% url 'accounts:login' %}"
      class="group relative w-full flex justify-center items-center py-4 px-6 bg-white text-brand-primary font-semibold text-base rounded-xl border-2 border-brand-primary shadow-lg hover:bg-brand-primary hover:text-white focus:outline-none focus:ring-4 focus:ring-brand-primary focus:ring-opacity-50 transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]"
    >
      <i class="fas fa-arrow-left mr-3 group-hover:text-white transition-colors duration-200"></i>
      Retour à la connexion
    </a>

    <button
      type="button"
      onclick="resendEmail()"
      class="group relative w-full flex justify-center items-center py-3 px-6 bg-gray-100 text-gray-700 font-medium text-sm rounded-xl hover:bg-gray-200 focus:outline-none focus:ring-4 focus:ring-gray-300 focus:ring-opacity-50 transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]"
    >
      <i class="fas fa-redo mr-3 text-gray-500 group-hover:text-gray-700 transition-colors duration-200"></i>
      Renvoyer l'email
    </button>
  </div>
</div>
{% endblock %}

{% block navigation_links %}
<div class="text-center space-y-6">
  <div class="p-6 bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl shadow-sm">
    <p class="text-green-800 font-medium mb-3">
      <i class="fas fa-question-circle mr-2 text-green-600" aria-hidden="true"></i>
      Vous ne recevez pas l'email ?
    </p>
    <div class="text-sm text-gray-600 space-y-3">
      <div class="flex items-start space-x-3">
        <i class="fas fa-check-circle text-green-500 mt-0.5"></i>
        <p>Vérifiez votre dossier spam/courrier indésirable</p>
      </div>
      <div class="flex items-start space-x-3">
        <i class="fas fa-check-circle text-green-500 mt-0.5"></i>
        <p>Assurez-vous que l'adresse email est correcte</p>
      </div>
      <div class="flex items-start space-x-3">
        <i class="fas fa-check-circle text-green-500 mt-0.5"></i>
        <p>Attendez quelques minutes avant de renvoyer</p>
      </div>
    </div>
    <div class="mt-6 pt-4 border-t border-green-200">
      <p class="text-xs text-gray-500">
        Toujours aucun email ?
        <a href="tel:+33769273776" class="font-medium text-brand-primary hover:underline">
          Contactez-nous
        </a>
      </p>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  function resendEmail() {
    // Redireciona para a página de reset de senha
    window.location.href = "{% url 'accounts:password_reset' %}";
  }

  // Auto-redirect animation
  document.addEventListener('DOMContentLoaded', function () {
    // Adiciona um contador visual se necessário
    let countdown = 30;
    const resendBtn = document.querySelector('button[onclick="resendEmail()"]');

    if (resendBtn) {
      const originalText = resendBtn.innerHTML;

      function updateCountdown() {
        if (countdown > 0) {
          resendBtn.disabled = true;
          resendBtn.innerHTML = `
            <span class="absolute left-0 inset-y-0 flex items-center pl-4">
              <i class="fas fa-clock text-gray-400"></i>
            </span>
            Renvoyer dans ${countdown}s
          `;
          countdown--;
          setTimeout(updateCountdown, 1000);
        } else {
          resendBtn.disabled = false;
          resendBtn.innerHTML = originalText;
        }
      }

      // Inicia o countdown apenas se o usuário acabou de chegar na página
      if (document.referrer.includes('password_reset') && !document.referrer.includes('password_reset_done')) {
        updateCountdown();
      }
    }
  });
</script>
{% endblock %}
