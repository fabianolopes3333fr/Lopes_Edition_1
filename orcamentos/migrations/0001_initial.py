# Generated by Django 5.2.6 on 2025-10-12 16:12

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('contenttypes', '0002_remove_content_type_name'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Fornecedor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nome', models.CharField(max_length=200, verbose_name='Nom du fournisseur')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),
                ('telefone', models.CharField(blank=True, max_length=20, validators=[django.core.validators.RegexValidator('^[\\+]?[0-9\\s\\-\\(\\)]+$')], verbose_name='Téléphone')),
                ('endereco', models.CharField(blank=True, max_length=255, verbose_name='Adresse')),
                ('cidade', models.CharField(blank=True, max_length=100, verbose_name='Ville')),
                ('cep', models.CharField(blank=True, max_length=10, verbose_name='Code postal')),
                ('ativo', models.BooleanField(default=True, verbose_name='Actif')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Fournisseur',
                'verbose_name_plural': 'Fournisseurs',
                'ordering': ['nome'],
            },
        ),
        migrations.CreateModel(
            name='Orcamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(editable=False, max_length=20, unique=True)),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('titulo', models.CharField(max_length=200, verbose_name='Titre du devis')),
                ('descricao', models.TextField(verbose_name='Description')),
                ('subtotal', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Sous-total')),
                ('desconto', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='Remise (%)')),
                ('valor_desconto', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Montant de la remise')),
                ('total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total')),
                ('prazo_execucao', models.PositiveIntegerField(verbose_name="Délai d'exécution (jours)")),
                ('validade_orcamento', models.DateField(verbose_name='Validité du devis')),
                ('condicoes_pagamento', models.CharField(choices=[('comptant', 'Comptant'), ('acompte_30', "30% d'acompte, solde à la fin"), ('acompte_50', "50% d'acompte, solde à la fin"), ('echeance_30', 'Paiement à 30 jours'), ('echeance_60', 'Paiement à 60 jours'), ('personnalise', 'Conditions personnalisées')], default='comptant', max_length=20, verbose_name='Conditions de paiement')),
                ('observacoes', models.TextField(blank=True, verbose_name='Observations')),
                ('status', models.CharField(choices=[('rascunho', 'Brouillon'), ('pendente', 'En attente'), ('em_elaboracao', "En cours d'élaboration"), ('enviado', 'Envoyé au client'), ('aceito', 'Accepté'), ('recusado', 'Refusé'), ('expirado', 'Expiré')], default='em_elaboracao', max_length=20, verbose_name='Statut')),
                ('tipo_pagamento', models.CharField(choices=[('virement', 'Virement bancaire'), ('cheque', 'Chèque'), ('espece', 'Espèce'), ('carte_bancaire', 'Carte bancaire')], default='virement', max_length=20, verbose_name='Type de paiement')),
                ('data_elaboracao', models.DateTimeField(auto_now_add=True)),
                ('data_envio', models.DateTimeField(blank=True, null=True)),
                ('data_resposta_cliente', models.DateTimeField(blank=True, null=True)),
                ('elaborado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='orcamentos_elaborados', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Devis',
                'verbose_name_plural': 'Devis',
                'ordering': ['-data_elaboracao'],
            },
        ),
        migrations.CreateModel(
            name='Facture',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(editable=False, max_length=20, unique=True)),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('titulo', models.CharField(max_length=200, verbose_name='Titre de la facture')),
                ('descricao', models.TextField(verbose_name='Description')),
                ('subtotal', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Sous-total')),
                ('desconto', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='Remise (%)')),
                ('valor_desconto', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Montant de la remise')),
                ('total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total')),
                ('data_emissao', models.DateField(default=django.utils.timezone.now, verbose_name="Date d'émission")),
                ('data_vencimento', models.DateField(verbose_name="Date d'échéance")),
                ('data_pagamento', models.DateField(blank=True, null=True, verbose_name='Date de paiement')),
                ('condicoes_pagamento', models.CharField(choices=[('comptant', 'Comptant'), ('acompte_30', "30% d'acompte, solde à la fin"), ('acompte_50', "50% d'acompte, solde à la fin"), ('echeance_30', 'Paiement à 30 jours'), ('echeance_60', 'Paiement à 60 jours'), ('personnalise', 'Conditions personnalisées')], default='comptant', max_length=20, verbose_name='Conditions de paiement')),
                ('tipo_pagamento', models.CharField(choices=[('virement', 'Virement bancaire'), ('cheque', 'Chèque'), ('espece', 'Espèce'), ('carte_bancaire', 'Carte bancaire')], default='virement', max_length=20, verbose_name='Type de paiement')),
                ('status', models.CharField(choices=[('brouillon', 'Brouillon'), ('envoyee', 'Envoyée'), ('payee', 'Payée'), ('annulee', 'Annulée'), ('en_retard', 'En retard')], default='brouillon', max_length=20, verbose_name='Statut')),
                ('observacoes', models.TextField(blank=True, verbose_name='Observations')),
                ('data_criacao', models.DateTimeField(auto_now_add=True)),
                ('data_envio', models.DateTimeField(blank=True, null=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cliente', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='faturas_cliente', to=settings.AUTH_USER_MODEL, verbose_name='Client')),
                ('elaborado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='faturas_elaboradas', to=settings.AUTH_USER_MODEL)),
                ('orcamento', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='faturas', to='orcamentos.orcamento', verbose_name='Devis de référence')),
            ],
            options={
                'verbose_name': 'Facture',
                'verbose_name_plural': 'Factures',
                'ordering': ['-data_criacao'],
            },
        ),
        migrations.CreateModel(
            name='Produto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('referencia', models.CharField(max_length=50, unique=True, verbose_name='Référence')),
                ('descricao', models.CharField(max_length=255, verbose_name='Désignation')),
                ('unidade', models.CharField(choices=[('unite', 'Unité'), ('piece', 'Pièce'), ('m2', 'M²'), ('ml', 'ML'), ('longueur', 'Longueur'), ('kg', 'Kg'), ('heure', 'Heure'), ('forfait', 'Forfait')], default='unite', max_length=20, verbose_name="Type d'unité")),
                ('atividade', models.CharField(choices=[('marchandise', 'Marchandise'), ('service', 'Service')], default='marchandise', max_length=20, verbose_name='Activité')),
                ('preco_compra', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name="Prix d'achat")),
                ('margem_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Marge HT')),
                ('margem_percentual', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='Marge HT em %')),
                ('preco_venda_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.Vente HT')),
                ('taxa_tva', models.CharField(choices=[('20', 'TVA 20%'), ('10', 'TVA 10%'), ('5.5', 'TVA 5,5%'), ('0', 'Exonérée')], default='20', max_length=5, verbose_name='Taxe TVA')),
                ('preco_venda_ttc', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.Vente TTC')),
                ('foto', models.ImageField(blank=True, null=True, upload_to='produtos/%Y/%m/', verbose_name='Photo')),
                ('ativo', models.BooleanField(default=True, verbose_name='Actif')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('fornecedor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='produtos', to='orcamentos.fornecedor', verbose_name='Fournisseur')),
            ],
            options={
                'verbose_name': 'Produit',
                'verbose_name_plural': 'Produits',
                'ordering': ['referencia'],
            },
        ),
        migrations.CreateModel(
            name='ItemOrcamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('referencia', models.CharField(blank=True, max_length=50, verbose_name='Référence')),
                ('descricao', models.CharField(max_length=255, verbose_name='Désignation')),
                ('unidade', models.CharField(choices=[('unite', 'Unité'), ('piece', 'Pièce'), ('m2', 'M²'), ('ml', 'ML'), ('longueur', 'Longueur'), ('kg', 'Kg'), ('heure', 'Heure'), ('forfait', 'Forfait')], default='unite', max_length=20, verbose_name='Unité')),
                ('atividade', models.CharField(choices=[('marchandise', 'Marchandise'), ('service', 'Service')], default='marchandise', max_length=20, verbose_name='Activité')),
                ('quantidade', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Quantité')),
                ('preco_unitario_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.U HT')),
                ('preco_unitario_ttc', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.U TTC')),
                ('preco_compra_unitario', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name="Prix d'achat unitaire")),
                ('remise_percentual', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='Remise (%)')),
                ('total_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total HT')),
                ('total_ttc', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total TTC')),
                ('taxa_tva', models.CharField(choices=[('20', 'TVA 20%'), ('10', 'TVA 10%'), ('5.5', 'TVA 5,5%'), ('0', 'Exonérée')], default='20', max_length=5, verbose_name='Taxe TVA')),
                ('ordem', models.PositiveIntegerField(default=0)),
                ('orcamento', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='itens', to='orcamentos.orcamento')),
                ('produto', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='orcamentos.produto', verbose_name='Produto de referência')),
            ],
            options={
                'verbose_name': 'Item du devis',
                'verbose_name_plural': 'Itens du devis',
                'ordering': ['ordem', 'id'],
            },
        ),
        migrations.CreateModel(
            name='ItemFacture',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('referencia', models.CharField(blank=True, max_length=50, verbose_name='Référence')),
                ('descricao', models.CharField(max_length=255, verbose_name='Désignation')),
                ('unidade', models.CharField(choices=[('unite', 'Unité'), ('piece', 'Pièce'), ('m2', 'M²'), ('ml', 'ML'), ('longueur', 'Longueur'), ('kg', 'Kg'), ('heure', 'Heure'), ('forfait', 'Forfait')], default='unite', max_length=20, verbose_name='Unité')),
                ('atividade', models.CharField(choices=[('marchandise', 'Marchandise'), ('service', 'Service')], default='marchandise', max_length=20, verbose_name='Activité')),
                ('quantidade', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Quantité')),
                ('preco_unitario_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.U HT')),
                ('preco_unitario_ttc', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='P.U TTC')),
                ('remise_percentual', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5, verbose_name='Remise (%)')),
                ('total_ht', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total HT')),
                ('total_ttc', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Total TTC')),
                ('taxa_tva', models.CharField(choices=[('20', 'TVA 20%'), ('10', 'TVA 10%'), ('5.5', 'TVA 5,5%'), ('0', 'Exonérée')], default='20', max_length=5, verbose_name='Taxe TVA')),
                ('ordem', models.PositiveIntegerField(default=0)),
                ('facture', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='itens', to='orcamentos.facture')),
                ('produto', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='orcamentos.produto', verbose_name='Produto de referência')),
            ],
            options={
                'verbose_name': 'Item de la facture',
                'verbose_name_plural': 'Itens de la facture',
                'ordering': ['ordem', 'id'],
            },
        ),
        migrations.CreateModel(
            name='Projeto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('titulo', models.CharField(max_length=200, verbose_name='Titre du projet')),
                ('descricao', models.TextField(verbose_name='Description détaillée')),
                ('tipo_servico', models.CharField(choices=[('pintura_interior', 'Peinture intérieure'), ('pintura_exterior', 'Peinture extérieure'), ('renovacao_completa', 'Rénovation complète'), ('preparacao_superficies', 'Préparation des surfaces'), ('decoracao', 'Décoration'), ('reparos', 'Réparations'), ('outro', 'Autre')], max_length=50, verbose_name='Type de service')),
                ('urgencia', models.CharField(choices=[('baixa', 'Pas pressé'), ('media', 'Normal'), ('alta', 'Urgent'), ('critica', 'Très urgent')], default='media', max_length=20, verbose_name='Urgence')),
                ('endereco_projeto', models.CharField(max_length=255, verbose_name='Adresse du projet')),
                ('cidade_projeto', models.CharField(max_length=100, verbose_name='Ville')),
                ('cep_projeto', models.CharField(max_length=10, verbose_name='Code postal')),
                ('area_aproximada', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='Surface approximative (m²)')),
                ('numero_comodos', models.PositiveIntegerField(blank=True, null=True, verbose_name='Nombre de pièces')),
                ('altura_teto', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='Hauteur du plafond (m)')),
                ('orcamento_estimado', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='Budget estimé (€)')),
                ('data_inicio_desejada', models.DateField(blank=True, null=True, verbose_name='Date de début souhaitée')),
                ('observacoes', models.TextField(blank=True, verbose_name='Observations particulières')),
                ('status', models.CharField(choices=[('planejando', 'En planification'), ('em_andamento', 'En cours'), ('concluido', 'Terminé'), ('pausado', 'En pause'), ('cancelado', 'Annulé')], default='planejando', max_length=20, verbose_name='Statut')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cliente', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='projetos', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Projet',
                'verbose_name_plural': 'Projets',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AnexoProjeto',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('arquivo', models.FileField(upload_to='projetos/anexos/%Y/%m/', verbose_name='Arquivo')),
                ('descricao', models.CharField(blank=True, max_length=255, verbose_name='Description')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('projeto', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='anexos', to='orcamentos.projeto')),
            ],
            options={
                'verbose_name': 'Anexo do projeto',
                'verbose_name_plural': 'Anexos do projeto',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='SolicitacaoOrcamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(editable=False, max_length=20, unique=True)),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('nome_solicitante', models.CharField(max_length=100, verbose_name='Nom')),
                ('email_solicitante', models.EmailField(max_length=254, verbose_name='Email')),
                ('telefone_solicitante', models.CharField(max_length=20, validators=[django.core.validators.RegexValidator('^[\\+]?[0-9\\s\\-\\(\\)]+$')], verbose_name='Téléphone')),
                ('endereco', models.CharField(max_length=255, verbose_name='Adresse')),
                ('cidade', models.CharField(max_length=100, verbose_name='Ville')),
                ('cep', models.CharField(max_length=10, verbose_name='Code postal')),
                ('tipo_servico', models.CharField(choices=[('pintura_interior', 'Peinture intérieure'), ('pintura_exterior', 'Peinture extérieure'), ('renovacao_completa', 'Rénovation complète'), ('preparacao_superficies', 'Préparation des surfaces'), ('decoracao', 'Décoration'), ('reparos', 'Réparations'), ('outro', 'Autre')], max_length=50, verbose_name='Type de service')),
                ('descricao_servico', models.TextField(verbose_name='Description du service')),
                ('area_aproximada', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='Surface approximative (m²)')),
                ('urgencia', models.CharField(choices=[('baixa', 'Pas pressé'), ('media', 'Normal'), ('alta', 'Urgent'), ('critica', 'Très urgent')], default='media', max_length=20, verbose_name='Urgence')),
                ('data_inicio_desejada', models.DateField(blank=True, null=True, verbose_name='Date de début souhaitée')),
                ('orcamento_maximo', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True, verbose_name='Budget maximum (€)')),
                ('observacoes', models.TextField(blank=True, verbose_name='Informations complémentaires')),
                ('status', models.CharField(choices=[('rascunho', 'Brouillon'), ('pendente', 'En attente'), ('em_elaboracao', "En cours d'élaboration"), ('enviado', 'Envoyé au client'), ('aceito', 'Accepté'), ('recusado', 'Refusé'), ('expirado', 'Expiré')], default='pendente', max_length=20, verbose_name='Statut')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('cliente', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='solicitacoes_orcamento', to=settings.AUTH_USER_MODEL)),
                ('projeto', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='solicitacoes_orcamento', to='orcamentos.projeto')),
            ],
            options={
                'verbose_name': 'Demande de devis',
                'verbose_name_plural': 'Demandes de devis',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='orcamento',
            name='solicitacao',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='orcamento', to='orcamentos.solicitacaoorcamento'),
        ),
        migrations.CreateModel(
            name='Notificacao',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('nova_solicitacao', 'Nouvelle demande de devis'), ('orcamento_elaborado', 'Devis élaboré'), ('orcamento_enviado', 'Devis envoyé'), ('orcamento_aceito', 'Devis accepté'), ('orcamento_recusado', 'Devis refusé'), ('projeto_criado', 'Nouveau projet créé'), ('fatura_criada', 'Nouvelle facture créée'), ('fatura_enviada', 'Facture envoyée'), ('fatura_paga', 'Facture payée')], max_length=30)),
                ('titulo', models.CharField(max_length=200)),
                ('mensagem', models.TextField()),
                ('lida', models.BooleanField(default=False)),
                ('url_acao', models.URLField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('usuario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notificacoes', to=settings.AUTH_USER_MODEL)),
                ('orcamento', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='orcamentos.orcamento')),
                ('projeto', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='orcamentos.projeto')),
                ('solicitacao', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='orcamentos.solicitacaoorcamento')),
            ],
            options={
                'verbose_name': 'Notification',
                'verbose_name_plural': 'Notifications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='LogAuditoria',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('sessao_id', models.CharField(blank=True, max_length=40)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('acao', models.CharField(choices=[('criacao', 'Création'), ('edicao', 'Modification'), ('exclusao', 'Suppression'), ('visualizacao', 'Consultation'), ('envio', 'Envoi'), ('aprovacao', 'Approbation'), ('rejeicao', 'Rejet'), ('cancelamento', 'Annulation'), ('download', 'Téléchargement'), ('vinculacao_orfao', 'Liaison demande orpheline'), ('deteccao_orfao', 'Détection demande orpheline'), ('processamento_lote', 'Traitement en lot'), ('notificacao_vinculacao', 'Notification de liaison'), ('criacao_fatura', 'Création de facture'), ('envio_fatura', 'Envoi de facture'), ('pagamento_fatura', 'Paiement de facture'), ('visualizacao_fatura', 'Consultation de facture'), ('download_fatura_pdf', 'Téléchargement PDF facture'), ('edicao_fatura', 'Modification de facture'), ('anulacao_fatura', 'Annulation de facture')], max_length=30, verbose_name='Action')),
                ('descricao', models.TextField(verbose_name='Description')),
                ('object_id', models.PositiveIntegerField()),
                ('dados_anteriores', models.JSONField(blank=True, null=True, verbose_name='Données précédentes')),
                ('dados_posteriores', models.JSONField(blank=True, null=True, verbose_name='Nouvelles données')),
                ('campos_alterados', models.JSONField(blank=True, null=True, verbose_name='Champs modifiés')),
                ('modulo', models.CharField(max_length=50, verbose_name='Module')),
                ('funcionalidade', models.CharField(max_length=100, verbose_name='Fonctionnalité')),
                ('sucesso', models.BooleanField(default=True)),
                ('erro_mensagem', models.TextField(blank=True)),
                ('content_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('usuario', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='logs_auditoria', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': "Log d'audit",
                'verbose_name_plural': "Logs d'audit",
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['timestamp'], name='orcamentos__timesta_77cd44_idx'), models.Index(fields=['usuario'], name='orcamentos__usuario_3c0485_idx'), models.Index(fields=['acao'], name='orcamentos__acao_57c2ff_idx'), models.Index(fields=['modulo'], name='orcamentos__modulo_a0084b_idx'), models.Index(fields=['content_type', 'object_id'], name='orcamentos__content_eab749_idx')],
            },
        ),
        migrations.CreateModel(
            name='AcompteOrcamento',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(editable=False, max_length=20, unique=True)),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('tipo', models.CharField(choices=[('inicial', 'Acompte initial'), ('intermediario', 'Acompte intermédiaire'), ('final', 'Solde final'), ('personalizado', 'Personnalisé')], default='inicial', max_length=20, verbose_name="Type d'acompte")),
                ('descricao', models.CharField(max_length=255, verbose_name='Description')),
                ('percentual', models.DecimalField(decimal_places=2, default=Decimal('30.00'), max_digits=5, verbose_name='Pourcentage (%)')),
                ('valor_ht', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Montant HT (€)')),
                ('valor_ttc', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='Montant TTC (€)')),
                ('valor_tva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10, verbose_name='Montant TVA (€)')),
                ('data_vencimento', models.DateField(verbose_name="Date d'échéance")),
                ('data_pagamento', models.DateField(blank=True, null=True, verbose_name='Date de paiement')),
                ('status', models.CharField(choices=[('pendente', 'En attente'), ('pago', 'Payé'), ('vencido', 'Échu'), ('cancelado', 'Annulé')], default='pendente', max_length=20, verbose_name='Statut')),
                ('tipo_pagamento', models.CharField(choices=[('virement', 'Virement bancaire'), ('cheque', 'Chèque'), ('espece', 'Espèce'), ('carte_bancaire', 'Carte bancaire')], default='virement', max_length=20, verbose_name='Type de paiement')),
                ('observacoes', models.TextField(blank=True, verbose_name='Observations')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('criado_por', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='acomptes_criados', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('fatura_acompte', models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acompte_origem', to='orcamentos.facture', verbose_name="Facture d'acompte")),
                ('orcamento', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='acomptes', to='orcamentos.orcamento', verbose_name='Devis')),
            ],
            options={
                'verbose_name': 'Acompte',
                'verbose_name_plural': 'Acomptes',
                'ordering': ['-created_at'],
                'unique_together': {('orcamento', 'numero')},
            },
        ),
    ]
